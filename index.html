<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Smart Tech Premium</title>
    <style>
        :root { 
            --primary-green: #4CAF50; 
            --accent-purple: #a435f0; 
            --glow-color: rgba(164, 53, 240, 0.4);
            --bg-color: #ffffff; 
        }
        body { margin: 0; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: var(--bg-color); font-family: sans-serif; overflow: hidden; }
        .purple-overlay { position: fixed; top: 50%; left: 50%; width: 10px; height: 10px; background: radial-gradient(circle, var(--accent-purple) 0%, #6a1b9a 100%); border-radius: 50%; transform: translate(-50%, -50%) scale(0); z-index: 1; pointer-events: none; }
        .active-burst { animation: burst-to-fill 1.2s cubic-bezier(0.19, 1, 0.22, 1) forwards; }
        @keyframes burst-to-fill { 0% { transform: translate(-50%, -50%) scale(0); } 100% { transform: translate(-50%, -50%) scale(500); } }
        .container { text-align: center; display: flex; flex-direction: column; align-items: center; position: relative; z-index: 10; }
        .logo-wrapper { width: 140px; height: 140px; margin-bottom: 30px; position: relative; border-radius: 50%; padding: 5px; display: flex; align-items: center; justify-content: center; overflow: hidden; background: #fff; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .logo-wrapper::before { content: ''; position: absolute; width: 150%; height: 150%; background: conic-gradient(transparent, transparent, var(--accent-purple), transparent); animation: rotate-border 3s linear infinite; }
        @keyframes rotate-border { 100% { transform: rotate(360deg); } }
        .logo-img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; z-index: 2; background: white; }
        .logo-active-anim { animation: premiumSpin 1.2s forwards; }
        @keyframes premiumSpin { 0% { transform: scale(1) rotate(0deg); } 100% { transform: scale(1.1) rotate(360deg); } }
        .white-text { color: white !important; transition: all 0.5s; }
        .loader { width: 30px; height: 30px; border: 3px solid #f3f3f3; border-top: 3px solid var(--primary-green); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 15px; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        h1 { font-size: 22px; font-weight: 800; color: #333; margin: 0; }
        .status-text { font-size: 15px; color: #888; margin-top: 10px; }
    </style>
</head>
<body>

    <div id="burstOverlay" class="purple-overlay"></div>

    <div class="container">
        <div class="logo-wrapper" id="logoWrapper">
            <img src="STP.png" alt="Logo" class="logo-img">
        </div>
        <div id="loader" class="loader"></div>
        <h1 id="mainTitle">Smart Tech Premium</h1>
        <p id="status" class="status-text">กำลังตรวจสอบข้อมูล</p>
    </div>

    <script>
        // URL ของ Google Apps Script ตัวล่าสุดที่คุณส่งมา
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbykdo2UqrC_y17HM07VktpufWOZnAxF388-Baey-bUWxyXTeqTTZivfTuDOdJuh_iYQxw/exec";
        const urlParams = new URLSearchParams(window.location.search);
        const locName = urlParams.get('loc') || "จุดแตะทั่วไป";

        // ส่งข้อมูลไปบันทึกที่ Sheets (ใช้ GET mode no-cors เพื่อความไวและไม่ติดบล็อก)
        fetch(`${SCRIPT_URL}?loc=${encodeURIComponent(locName)}`, { 
            method: 'GET',
            mode: 'no-cors', 
            cache: 'no-cache'
        });

        const logoWrapper = document.getElementById('logoWrapper');
        const loader = document.getElementById('loader');
        const statusText = document.getElementById('status');
        const mainTitle = document.getElementById('mainTitle');
        const burstOverlay = document.getElementById('burstOverlay');

        // เริ่มอนิเมชั่นระเบิดหลัง 2 วินาที
        setTimeout(() => {
            loader.style.display = 'none';
            burstOverlay.classList.add('active-burst');
            logoWrapper.classList.add('logo-active-anim');
            statusText.classList.add('white-text');
            mainTitle.classList.add('white-text');
            statusText.innerText = "กำลังย้ายท่านไปยังเพจ";
        }, 2000); 

        // เปลี่ยนหน้าไป Facebook หลัง 4 วินาที
        setTimeout(() => {
            window.location.replace("https://m.facebook.com/sswsmarttech/");
        }, 4000);
    </script>
</body>
</html>
